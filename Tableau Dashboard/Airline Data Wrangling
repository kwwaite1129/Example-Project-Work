{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Import the necessary packages and import the html file. Open the file with Beautiful Soup\n",
    "from bs4 import BeautifulSoup\n",
    "import requests\n",
    "import pandas as pd\n",
    "import re\n",
    "airline_data_url=\"https://github.com/fivethirtyeight/data/blob/master/airline-safety/airline-safety.csv\"\n",
    "\n",
    "# Make a GET request to fetch the raw HTML content\n",
    "airline_content = requests.get(airline_data_url).text\n",
    "\n",
    "# Parse the html content\n",
    "airline_soup = BeautifulSoup(airline_content, \"lxml\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['airline',\n",
       " 'avail_seat_km_per_week',\n",
       " 'incidents_85_99',\n",
       " 'fatal_accidents_85_99',\n",
       " 'fatalities_85_99',\n",
       " 'incidents_00_14',\n",
       " 'fatal_accidents_00_14',\n",
       " 'fatalities_00_14']"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "airline_col_header = []\n",
    "airline_headers = airline_soup.find_all(\"th\")\n",
    "for th in airline_headers:\n",
    "    airline_col_header.append(th.text)\n",
    "airline_col_header"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>airline</th>\n",
       "      <th>avail_seat_km_per_week</th>\n",
       "      <th>incidents_85_99</th>\n",
       "      <th>fatal_accidents_85_99</th>\n",
       "      <th>fatalities_85_99</th>\n",
       "      <th>incidents_00_14</th>\n",
       "      <th>fatal_accidents_00_14</th>\n",
       "      <th>fatalities_00_14</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Aer Lingus</td>\n",
       "      <td>320906734</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Aeroflot*</td>\n",
       "      <td>1197672318</td>\n",
       "      <td>76</td>\n",
       "      <td>14</td>\n",
       "      <td>128</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Aerolineas Argentinas</td>\n",
       "      <td>385803648</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Aeromexico*</td>\n",
       "      <td>596871813</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>64</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Air Canada</td>\n",
       "      <td>1865253802</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Air France</td>\n",
       "      <td>3004002661</td>\n",
       "      <td>14</td>\n",
       "      <td>4</td>\n",
       "      <td>79</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>337</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Air India*</td>\n",
       "      <td>869253552</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>329</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>158</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Air New Zealand*</td>\n",
       "      <td>710174817</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Alaska Airlines*</td>\n",
       "      <td>965346773</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Alitalia</td>\n",
       "      <td>698012498</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>50</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>All Nippon Airways</td>\n",
       "      <td>1841234177</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>American*</td>\n",
       "      <td>5228357340</td>\n",
       "      <td>21</td>\n",
       "      <td>5</td>\n",
       "      <td>101</td>\n",
       "      <td>17</td>\n",
       "      <td>3</td>\n",
       "      <td>416</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Austrian Airlines</td>\n",
       "      <td>358239823</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Avianca</td>\n",
       "      <td>396922563</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>323</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>British Airways*</td>\n",
       "      <td>3179760952</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Cathay Pacific*</td>\n",
       "      <td>2582459303</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>China Airlines</td>\n",
       "      <td>813216487</td>\n",
       "      <td>12</td>\n",
       "      <td>6</td>\n",
       "      <td>535</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>225</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Condor</td>\n",
       "      <td>417982610</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>16</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>COPA</td>\n",
       "      <td>550491507</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>47</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Delta / Northwest*</td>\n",
       "      <td>6525658894</td>\n",
       "      <td>24</td>\n",
       "      <td>12</td>\n",
       "      <td>407</td>\n",
       "      <td>24</td>\n",
       "      <td>2</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Egyptair</td>\n",
       "      <td>557699891</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>282</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>El Al</td>\n",
       "      <td>335448023</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Ethiopian Airlines</td>\n",
       "      <td>488560643</td>\n",
       "      <td>25</td>\n",
       "      <td>5</td>\n",
       "      <td>167</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Finnair</td>\n",
       "      <td>506464950</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Garuda Indonesia</td>\n",
       "      <td>613356665</td>\n",
       "      <td>10</td>\n",
       "      <td>3</td>\n",
       "      <td>260</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Gulf Air</td>\n",
       "      <td>301379762</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>143</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Hawaiian Airlines</td>\n",
       "      <td>493877795</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>Iberia</td>\n",
       "      <td>1173203126</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>148</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>Japan Airlines</td>\n",
       "      <td>1574217531</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>520</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>Kenya Airways</td>\n",
       "      <td>277414794</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>283</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>KLM*</td>\n",
       "      <td>1874561773</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>Korean Air</td>\n",
       "      <td>1734522605</td>\n",
       "      <td>12</td>\n",
       "      <td>5</td>\n",
       "      <td>425</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>LAN Airlines</td>\n",
       "      <td>1001965891</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>21</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>Lufthansa*</td>\n",
       "      <td>3426529504</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>Malaysia Airlines</td>\n",
       "      <td>1039171244</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>34</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>537</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>Pakistan International</td>\n",
       "      <td>348563137</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>234</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>Philippine Airlines</td>\n",
       "      <td>413007158</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>74</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>Qantas*</td>\n",
       "      <td>1917428984</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>Royal Air Maroc</td>\n",
       "      <td>295705339</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>51</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>SAS*</td>\n",
       "      <td>682971852</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>110</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>Saudi Arabian</td>\n",
       "      <td>859673901</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>313</td>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>Singapore Airlines</td>\n",
       "      <td>2376857805</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>South African</td>\n",
       "      <td>651502442</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>159</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>Southwest Airlines</td>\n",
       "      <td>3276525770</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>Sri Lankan / AirLanka</td>\n",
       "      <td>325582976</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>14</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>SWISS*</td>\n",
       "      <td>792601299</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>229</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>TACA</td>\n",
       "      <td>259373346</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>TAM</td>\n",
       "      <td>1509195646</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>98</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>188</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>TAP - Air Portugal</td>\n",
       "      <td>619130754</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>Thai Airways</td>\n",
       "      <td>1702802250</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>308</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>51</th>\n",
       "      <td>Turkish Airlines</td>\n",
       "      <td>1946098294</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>64</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52</th>\n",
       "      <td>United / Continental*</td>\n",
       "      <td>7139291291</td>\n",
       "      <td>19</td>\n",
       "      <td>8</td>\n",
       "      <td>319</td>\n",
       "      <td>14</td>\n",
       "      <td>2</td>\n",
       "      <td>109</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>US Airways / America West*</td>\n",
       "      <td>2455687887</td>\n",
       "      <td>16</td>\n",
       "      <td>7</td>\n",
       "      <td>224</td>\n",
       "      <td>11</td>\n",
       "      <td>2</td>\n",
       "      <td>23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54</th>\n",
       "      <td>Vietnam Airlines</td>\n",
       "      <td>625084918</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>171</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55</th>\n",
       "      <td>Virgin Atlantic</td>\n",
       "      <td>1005248585</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56</th>\n",
       "      <td>Xiamen Airlines</td>\n",
       "      <td>430462962</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>82</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                       airline avail_seat_km_per_week incidents_85_99  \\\n",
       "1                   Aer Lingus              320906734               2   \n",
       "2                    Aeroflot*             1197672318              76   \n",
       "3        Aerolineas Argentinas              385803648               6   \n",
       "4                  Aeromexico*              596871813               3   \n",
       "5                   Air Canada             1865253802               2   \n",
       "6                   Air France             3004002661              14   \n",
       "7                   Air India*              869253552               2   \n",
       "8             Air New Zealand*              710174817               3   \n",
       "9             Alaska Airlines*              965346773               5   \n",
       "10                    Alitalia              698012498               7   \n",
       "11          All Nippon Airways             1841234177               3   \n",
       "12                   American*             5228357340              21   \n",
       "13           Austrian Airlines              358239823               1   \n",
       "14                     Avianca              396922563               5   \n",
       "15            British Airways*             3179760952               4   \n",
       "16             Cathay Pacific*             2582459303               0   \n",
       "17              China Airlines              813216487              12   \n",
       "18                      Condor              417982610               2   \n",
       "19                        COPA              550491507               3   \n",
       "20          Delta / Northwest*             6525658894              24   \n",
       "21                    Egyptair              557699891               8   \n",
       "22                       El Al              335448023               1   \n",
       "23          Ethiopian Airlines              488560643              25   \n",
       "24                     Finnair              506464950               1   \n",
       "25            Garuda Indonesia              613356665              10   \n",
       "26                    Gulf Air              301379762               1   \n",
       "27           Hawaiian Airlines              493877795               0   \n",
       "28                      Iberia             1173203126               4   \n",
       "29              Japan Airlines             1574217531               3   \n",
       "30               Kenya Airways              277414794               2   \n",
       "31                        KLM*             1874561773               7   \n",
       "32                  Korean Air             1734522605              12   \n",
       "33                LAN Airlines             1001965891               3   \n",
       "34                  Lufthansa*             3426529504               6   \n",
       "35           Malaysia Airlines             1039171244               3   \n",
       "36      Pakistan International              348563137               8   \n",
       "37         Philippine Airlines              413007158               7   \n",
       "38                     Qantas*             1917428984               1   \n",
       "39             Royal Air Maroc              295705339               5   \n",
       "40                        SAS*              682971852               5   \n",
       "41               Saudi Arabian              859673901               7   \n",
       "42          Singapore Airlines             2376857805               2   \n",
       "43               South African              651502442               2   \n",
       "44          Southwest Airlines             3276525770               1   \n",
       "45       Sri Lankan / AirLanka              325582976               2   \n",
       "46                      SWISS*              792601299               2   \n",
       "47                        TACA              259373346               3   \n",
       "48                         TAM             1509195646               8   \n",
       "49          TAP - Air Portugal              619130754               0   \n",
       "50                Thai Airways             1702802250               8   \n",
       "51            Turkish Airlines             1946098294               8   \n",
       "52       United / Continental*             7139291291              19   \n",
       "53  US Airways / America West*             2455687887              16   \n",
       "54            Vietnam Airlines              625084918               7   \n",
       "55             Virgin Atlantic             1005248585               1   \n",
       "56             Xiamen Airlines              430462962               9   \n",
       "\n",
       "   fatal_accidents_85_99 fatalities_85_99 incidents_00_14  \\\n",
       "1                      0                0               0   \n",
       "2                     14              128               6   \n",
       "3                      0                0               1   \n",
       "4                      1               64               5   \n",
       "5                      0                0               2   \n",
       "6                      4               79               6   \n",
       "7                      1              329               4   \n",
       "8                      0                0               5   \n",
       "9                      0                0               5   \n",
       "10                     2               50               4   \n",
       "11                     1                1               7   \n",
       "12                     5              101              17   \n",
       "13                     0                0               1   \n",
       "14                     3              323               0   \n",
       "15                     0                0               6   \n",
       "16                     0                0               2   \n",
       "17                     6              535               2   \n",
       "18                     1               16               0   \n",
       "19                     1               47               0   \n",
       "20                    12              407              24   \n",
       "21                     3              282               4   \n",
       "22                     1                4               1   \n",
       "23                     5              167               5   \n",
       "24                     0                0               0   \n",
       "25                     3              260               4   \n",
       "26                     0                0               3   \n",
       "27                     0                0               1   \n",
       "28                     1              148               5   \n",
       "29                     1              520               0   \n",
       "30                     0                0               2   \n",
       "31                     1                3               1   \n",
       "32                     5              425               1   \n",
       "33                     2               21               0   \n",
       "34                     1                2               3   \n",
       "35                     1               34               3   \n",
       "36                     3              234              10   \n",
       "37                     4               74               2   \n",
       "38                     0                0               5   \n",
       "39                     3               51               3   \n",
       "40                     0                0               6   \n",
       "41                     2              313              11   \n",
       "42                     2                6               2   \n",
       "43                     1              159               1   \n",
       "44                     0                0               8   \n",
       "45                     1               14               4   \n",
       "46                     1              229               3   \n",
       "47                     1                3               1   \n",
       "48                     3               98               7   \n",
       "49                     0                0               0   \n",
       "50                     4              308               2   \n",
       "51                     3               64               8   \n",
       "52                     8              319              14   \n",
       "53                     7              224              11   \n",
       "54                     3              171               1   \n",
       "55                     0                0               0   \n",
       "56                     1               82               2   \n",
       "\n",
       "   fatal_accidents_00_14 fatalities_00_14  \n",
       "1                      0                0  \n",
       "2                      1               88  \n",
       "3                      0                0  \n",
       "4                      0                0  \n",
       "5                      0                0  \n",
       "6                      2              337  \n",
       "7                      1              158  \n",
       "8                      1                7  \n",
       "9                      1               88  \n",
       "10                     0                0  \n",
       "11                     0                0  \n",
       "12                     3              416  \n",
       "13                     0                0  \n",
       "14                     0                0  \n",
       "15                     0                0  \n",
       "16                     0                0  \n",
       "17                     1              225  \n",
       "18                     0                0  \n",
       "19                     0                0  \n",
       "20                     2               51  \n",
       "21                     1               14  \n",
       "22                     0                0  \n",
       "23                     2               92  \n",
       "24                     0                0  \n",
       "25                     2               22  \n",
       "26                     1              143  \n",
       "27                     0                0  \n",
       "28                     0                0  \n",
       "29                     0                0  \n",
       "30                     2              283  \n",
       "31                     0                0  \n",
       "32                     0                0  \n",
       "33                     0                0  \n",
       "34                     0                0  \n",
       "35                     2              537  \n",
       "36                     2               46  \n",
       "37                     1                1  \n",
       "38                     0                0  \n",
       "39                     0                0  \n",
       "40                     1              110  \n",
       "41                     0                0  \n",
       "42                     1               83  \n",
       "43                     0                0  \n",
       "44                     0                0  \n",
       "45                     0                0  \n",
       "46                     0                0  \n",
       "47                     1                3  \n",
       "48                     2              188  \n",
       "49                     0                0  \n",
       "50                     1                1  \n",
       "51                     2               84  \n",
       "52                     2              109  \n",
       "53                     2               23  \n",
       "54                     0                0  \n",
       "55                     0                0  \n",
       "56                     0                0  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "airline_data = []\n",
    "air_data = airline_soup.find_all(\"tr\")\n",
    "for tr in air_data:\n",
    "    airline_data.append(tr.text)\n",
    "airline_df = pd.DataFrame(airline_data)\n",
    "airline_df.columns = ['Data']\n",
    "airline_df = airline_df.Data.str.split(\"\\n\",expand=True)\n",
    "airline_df = airline_df.drop([0, 1,10], axis = 1)\n",
    "airline_df = airline_df.drop([0])\n",
    "airline_df.columns = airline_col_header\n",
    "airline_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "airline_df.to_csv('airline_data.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "veh_url=\"https://www-fars.nhtsa.dot.gov/Main/index.aspx\"\n",
    "\n",
    "# Make a GET request to fetch the raw HTML content\n",
    "veh_content = requests.get(veh_url).text\n",
    "\n",
    "# Parse the html content\n",
    "veh_soup = BeautifulSoup(veh_content, \"lxml\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['2018',\n",
       " '2017',\n",
       " '2016',\n",
       " '2015',\n",
       " '2014',\n",
       " '2013',\n",
       " '2012',\n",
       " '2011',\n",
       " '2010',\n",
       " '2009',\n",
       " '2008',\n",
       " '2007',\n",
       " '2006',\n",
       " '2005',\n",
       " '2004',\n",
       " '2003',\n",
       " '2002',\n",
       " '2001',\n",
       " '2000',\n",
       " '1999',\n",
       " '1998',\n",
       " '1997',\n",
       " '1996',\n",
       " '1995',\n",
       " '1994']"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vehicle_header = []\n",
    "veh_headers = veh_soup.find(\"tr\", attrs={\"class\": \"hdr01_home\"})\n",
    "for th in veh_headers:\n",
    "    th = th.text\n",
    "    th = th.strip()\n",
    "    vehicle_header.append(th)\n",
    "vehicle_header = vehicle_header[1:]\n",
    "vehicle_header"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Fatalities per 100 Million Vehicle Miles Traveled</th>\n",
       "      <th>Year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.13</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.17</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.19</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.15</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.08</td>\n",
       "      <td>2014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1.10</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1.14</td>\n",
       "      <td>2012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1.10</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1.11</td>\n",
       "      <td>2010</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1.15</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1.26</td>\n",
       "      <td>2008</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>1.36</td>\n",
       "      <td>2007</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1.42</td>\n",
       "      <td>2006</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>1.46</td>\n",
       "      <td>2005</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>1.44</td>\n",
       "      <td>2004</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>1.48</td>\n",
       "      <td>2003</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>1.51</td>\n",
       "      <td>2002</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1.51</td>\n",
       "      <td>2001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>1.53</td>\n",
       "      <td>2000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1.55</td>\n",
       "      <td>1999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>1.58</td>\n",
       "      <td>1998</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>1.65</td>\n",
       "      <td>1997</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>1.69</td>\n",
       "      <td>1996</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1.73</td>\n",
       "      <td>1995</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1.73</td>\n",
       "      <td>1994</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Fatalities per 100 Million Vehicle Miles Traveled  Year\n",
       "0                                               1.13  2018\n",
       "1                                               1.17  2017\n",
       "2                                               1.19  2016\n",
       "3                                               1.15  2015\n",
       "4                                               1.08  2014\n",
       "5                                               1.10  2013\n",
       "6                                               1.14  2012\n",
       "7                                               1.10  2011\n",
       "8                                               1.11  2010\n",
       "9                                               1.15  2009\n",
       "10                                              1.26  2008\n",
       "11                                              1.36  2007\n",
       "12                                              1.42  2006\n",
       "13                                              1.46  2005\n",
       "14                                              1.44  2004\n",
       "15                                              1.48  2003\n",
       "16                                              1.51  2002\n",
       "17                                              1.51  2001\n",
       "18                                              1.53  2000\n",
       "19                                              1.55  1999\n",
       "20                                              1.58  1998\n",
       "21                                              1.65  1997\n",
       "22                                              1.69  1996\n",
       "23                                              1.73  1995\n",
       "24                                              1.73  1994"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "fatality_rate = []\n",
    "fatality_data = veh_soup.find_all(\"td\", attrs={\"headers\": re.compile(\"hdr21 hdrCol.*\")})\n",
    "for td in fatality_data:\n",
    "    fatality_rate.append(td.text)\n",
    "df_fr = pd.DataFrame(fatality_rate)\n",
    "df_fr.columns = ['Fatalities per 100 Million Vehicle Miles Traveled']\n",
    "df_fr['Year'] = vehicle_header\n",
    "df_fr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_fr.to_csv('car_fatality_data.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "url_total_rev=\"http://web.mit.edu/airlinedata/www/2019%2012%20Month%20Documents/Traffic%20and%20Capacity/System%20Total/Total%20System%20Revenue%20Passenger%20Miles.htm\"\n",
    "\n",
    "total_rev_html_content = requests.get(url_total_rev).text\n",
    "\n",
    "soup_total_rev = BeautifulSoup(total_rev_html_content, \"lxml\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "total_rev_header = []\n",
    "total_rev_headers = soup_total_rev.find_all(\"td\", attrs={\"class\": \"xl728262\"})\n",
    "for td in total_rev_headers:\n",
    "    total_rev_header.append(td.text)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "total_revenue = []\n",
    "total_rev = soup_total_rev.find_all(\"td\", attrs={\"class\": \"xl778262\"})\n",
    "for td in total_rev:\n",
    "    total_revenue.append(td.text)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Total Revenue Passenger Miles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>557,234</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>598,203</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>622,234</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>635,795</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>670,779</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>708,762</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>725,027</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>655,250</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>673,997</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>751,593</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>794,613</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>810,120</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>842,026</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>823,783</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>779,997</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>809,068</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>825,916</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>832,734</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>848,000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>869,677</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>908,795</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>939,118</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>969,904</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1,016,918</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1,060,859</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Total Revenue Passenger Miles\n",
       "0                       557,234 \n",
       "1                       598,203 \n",
       "2                       622,234 \n",
       "3                       635,795 \n",
       "4                       670,779 \n",
       "5                       708,762 \n",
       "6                       725,027 \n",
       "7                       655,250 \n",
       "8                       673,997 \n",
       "9                       751,593 \n",
       "10                      794,613 \n",
       "11                      810,120 \n",
       "12                      842,026 \n",
       "13                      823,783 \n",
       "14                      779,997 \n",
       "15                      809,068 \n",
       "16                      825,916 \n",
       "17                      832,734 \n",
       "18                      848,000 \n",
       "19                      869,677 \n",
       "20                      908,795 \n",
       "21                      939,118 \n",
       "22                      969,904 \n",
       "23                    1,016,918 \n",
       "24                    1,060,859 "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_tr = pd.DataFrame(total_revenue)\n",
    "df_tr.columns = ['Total Revenue Passenger Miles']\n",
    "df_tr = df_tr.iloc[114:139]\n",
    "df_tr = df_tr['Total Revenue Passenger Miles'].str.split(\"\\n\",expand=True)\n",
    "df_tr = df_tr.drop([0], axis = 1)\n",
    "df_tr.columns = ['Total Revenue Passenger Miles']\n",
    "df_tr = df_tr.reset_index()\n",
    "df_tr = df_tr.drop(['index'], axis = 1)\n",
    "df_tr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "url_dom_rev=\"http://web.mit.edu/airlinedata/www/2019%2012%20Month%20Documents/Traffic%20and%20Capacity/Domestic/Domestic%20Revenue%20Passenger%20Miles.htm\"\n",
    "\n",
    "dom_rev_html_content = requests.get(url_dom_rev).text\n",
    "\n",
    "soup_dom_rev = BeautifulSoup(dom_rev_html_content, \"lxml\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Total Revenue Passenger Miles</th>\n",
       "      <th>Total Domestic Revenue Passenger Miles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>557,234</td>\n",
       "      <td>402,776</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>598,203</td>\n",
       "      <td>436,647</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>622,234</td>\n",
       "      <td>453,023</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>635,795</td>\n",
       "      <td>463,618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>670,779</td>\n",
       "      <td>489,655</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>708,762</td>\n",
       "      <td>515,703</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>725,027</td>\n",
       "      <td>503,471</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>655,250</td>\n",
       "      <td>483,253</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>673,997</td>\n",
       "      <td>505,420</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>751,593</td>\n",
       "      <td>557,936</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>794,613</td>\n",
       "      <td>583,625</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>810,120</td>\n",
       "      <td>590,592</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>842,026</td>\n",
       "      <td>606,909</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>823,783</td>\n",
       "      <td>583,232</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>779,997</td>\n",
       "      <td>552,097</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>809,068</td>\n",
       "      <td>564,695</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>825,916</td>\n",
       "      <td>575,613</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>832,734</td>\n",
       "      <td>580,501</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>848,000</td>\n",
       "      <td>589,692</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>869,677</td>\n",
       "      <td>607,772</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>908,795</td>\n",
       "      <td>641,905</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>939,118</td>\n",
       "      <td>670,371</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>969,904</td>\n",
       "      <td>693,818</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1,016,918</td>\n",
       "      <td>730,721</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1,060,859</td>\n",
       "      <td>762,889</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Total Revenue Passenger Miles Total Domestic Revenue Passenger Miles\n",
       "0                       557,234                                402,776 \n",
       "1                       598,203                                436,647 \n",
       "2                       622,234                                453,023 \n",
       "3                       635,795                                463,618 \n",
       "4                       670,779                                489,655 \n",
       "5                       708,762                                515,703 \n",
       "6                       725,027                                503,471 \n",
       "7                       655,250                                483,253 \n",
       "8                       673,997                                505,420 \n",
       "9                       751,593                                557,936 \n",
       "10                      794,613                                583,625 \n",
       "11                      810,120                                590,592 \n",
       "12                      842,026                                606,909 \n",
       "13                      823,783                                583,232 \n",
       "14                      779,997                                552,097 \n",
       "15                      809,068                                564,695 \n",
       "16                      825,916                                575,613 \n",
       "17                      832,734                                580,501 \n",
       "18                      848,000                                589,692 \n",
       "19                      869,677                                607,772 \n",
       "20                      908,795                                641,905 \n",
       "21                      939,118                                670,371 \n",
       "22                      969,904                                693,818 \n",
       "23                    1,016,918                                730,721 \n",
       "24                    1,060,859                                762,889 "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dom_revenue = []\n",
    "total_dom_rev = soup_dom_rev.find_all(\"td\", attrs={\"class\": \"xl774871\"})\n",
    "for td in total_dom_rev:\n",
    "    dom_revenue.append(td.text)\n",
    "df_dr = pd.DataFrame(dom_revenue)\n",
    "df_dr.columns = ['Total Domestic Revenue Passenger Miles']\n",
    "df_dr = df_dr.iloc[125:]\n",
    "df_dr = df_dr['Total Domestic Revenue Passenger Miles'].str.split(\"\\n\",expand=True)\n",
    "df_dr = df_dr.drop([0], axis = 1)\n",
    "df_dr.columns = ['Total Domestic Revenue Passenger Miles']\n",
    "df_tr['Total Domestic Revenue Passenger Miles'] = df_dr['Total Domestic Revenue Passenger Miles'].to_list()\n",
    "df_tr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "url_intl_rev=\"http://web.mit.edu/airlinedata/www/2019%2012%20Month%20Documents/Traffic%20and%20Capacity/International/International%20Revenue%20Passenger%20Miles.htm\"\n",
    "\n",
    "intl_rev_html_content = requests.get(url_intl_rev).text\n",
    "\n",
    "soup_intl_rev = BeautifulSoup(intl_rev_html_content, \"lxml\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Total Revenue Passenger Miles</th>\n",
       "      <th>Total Domestic Revenue Passenger Miles</th>\n",
       "      <th>Total International Revenue Passenger Miles</th>\n",
       "      <th>Year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>557,234</td>\n",
       "      <td>402,776</td>\n",
       "      <td>151,032</td>\n",
       "      <td>1995</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>598,203</td>\n",
       "      <td>436,647</td>\n",
       "      <td>156,796</td>\n",
       "      <td>1996</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>622,234</td>\n",
       "      <td>453,023</td>\n",
       "      <td>164,848</td>\n",
       "      <td>1997</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>635,795</td>\n",
       "      <td>463,618</td>\n",
       "      <td>166,962</td>\n",
       "      <td>1998</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>670,779</td>\n",
       "      <td>489,655</td>\n",
       "      <td>175,316</td>\n",
       "      <td>1999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>708,762</td>\n",
       "      <td>515,703</td>\n",
       "      <td>187,404</td>\n",
       "      <td>2000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>725,027</td>\n",
       "      <td>503,471</td>\n",
       "      <td>173,617</td>\n",
       "      <td>2001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>655,250</td>\n",
       "      <td>483,253</td>\n",
       "      <td>167,341</td>\n",
       "      <td>2002</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>673,997</td>\n",
       "      <td>505,420</td>\n",
       "      <td>161,066</td>\n",
       "      <td>2003</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>751,593</td>\n",
       "      <td>557,936</td>\n",
       "      <td>185,009</td>\n",
       "      <td>2004</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>794,613</td>\n",
       "      <td>583,625</td>\n",
       "      <td>201,935</td>\n",
       "      <td>2005</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>810,120</td>\n",
       "      <td>590,592</td>\n",
       "      <td>213,858</td>\n",
       "      <td>2006</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>842,026</td>\n",
       "      <td>606,909</td>\n",
       "      <td>226,972</td>\n",
       "      <td>2007</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>823,783</td>\n",
       "      <td>583,232</td>\n",
       "      <td>232,462</td>\n",
       "      <td>2008</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>779,997</td>\n",
       "      <td>552,097</td>\n",
       "      <td>221,317</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>809,068</td>\n",
       "      <td>564,695</td>\n",
       "      <td>237,247</td>\n",
       "      <td>2010</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>825,916</td>\n",
       "      <td>575,613</td>\n",
       "      <td>243,228</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>832,734</td>\n",
       "      <td>580,501</td>\n",
       "      <td>247,547</td>\n",
       "      <td>2012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>848,000</td>\n",
       "      <td>589,692</td>\n",
       "      <td>254,558</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>869,677</td>\n",
       "      <td>607,772</td>\n",
       "      <td>258,511</td>\n",
       "      <td>2014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>908,795</td>\n",
       "      <td>641,905</td>\n",
       "      <td>264,094</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>939,118</td>\n",
       "      <td>670,371</td>\n",
       "      <td>266,088</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>969,904</td>\n",
       "      <td>693,818</td>\n",
       "      <td>273,633</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1,016,918</td>\n",
       "      <td>730,721</td>\n",
       "      <td>283,189</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1,060,859</td>\n",
       "      <td>762,889</td>\n",
       "      <td>295,009</td>\n",
       "      <td>2019</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Total Revenue Passenger Miles Total Domestic Revenue Passenger Miles  \\\n",
       "0                       557,234                                402,776    \n",
       "1                       598,203                                436,647    \n",
       "2                       622,234                                453,023    \n",
       "3                       635,795                                463,618    \n",
       "4                       670,779                                489,655    \n",
       "5                       708,762                                515,703    \n",
       "6                       725,027                                503,471    \n",
       "7                       655,250                                483,253    \n",
       "8                       673,997                                505,420    \n",
       "9                       751,593                                557,936    \n",
       "10                      794,613                                583,625    \n",
       "11                      810,120                                590,592    \n",
       "12                      842,026                                606,909    \n",
       "13                      823,783                                583,232    \n",
       "14                      779,997                                552,097    \n",
       "15                      809,068                                564,695    \n",
       "16                      825,916                                575,613    \n",
       "17                      832,734                                580,501    \n",
       "18                      848,000                                589,692    \n",
       "19                      869,677                                607,772    \n",
       "20                      908,795                                641,905    \n",
       "21                      939,118                                670,371    \n",
       "22                      969,904                                693,818    \n",
       "23                    1,016,918                                730,721    \n",
       "24                    1,060,859                                762,889    \n",
       "\n",
       "   Total International Revenue Passenger Miles  Year  \n",
       "0                                     151,032   1995  \n",
       "1                                     156,796   1996  \n",
       "2                                     164,848   1997  \n",
       "3                                     166,962   1998  \n",
       "4                                     175,316   1999  \n",
       "5                                     187,404   2000  \n",
       "6                                     173,617   2001  \n",
       "7                                     167,341   2002  \n",
       "8                                     161,066   2003  \n",
       "9                                     185,009   2004  \n",
       "10                                    201,935   2005  \n",
       "11                                    213,858   2006  \n",
       "12                                    226,972   2007  \n",
       "13                                    232,462   2008  \n",
       "14                                    221,317   2009  \n",
       "15                                    237,247   2010  \n",
       "16                                    243,228   2011  \n",
       "17                                    247,547   2012  \n",
       "18                                    254,558   2013  \n",
       "19                                    258,511   2014  \n",
       "20                                    264,094   2015  \n",
       "21                                    266,088   2016  \n",
       "22                                    273,633   2017  \n",
       "23                                    283,189   2018  \n",
       "24                                    295,009   2019  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "intl_revenue = []\n",
    "total_intl_rev = soup_intl_rev.find_all(\"td\", attrs={\"class\": \"xl775725\"})\n",
    "for td in total_intl_rev:\n",
    "    intl_revenue.append(td.text)\n",
    "df_ir = pd.DataFrame(intl_revenue)\n",
    "df_ir.columns = ['Total International Revenue Passenger Miles']\n",
    "df_ir = df_ir.iloc[125:]\n",
    "df_ir = df_ir['Total International Revenue Passenger Miles'].str.split(\"\\n\",expand=True)\n",
    "df_ir = df_ir.drop([0], axis = 1)\n",
    "df_ir.columns = ['Total International Revenue Passenger Miles']\n",
    "df_tr['Total International Revenue Passenger Miles'] = df_ir['Total International Revenue Passenger Miles'].to_list()\n",
    "df_tr['Year'] = total_rev_header\n",
    "df_tr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Revenue</th>\n",
       "      <th>Year</th>\n",
       "      <th>Category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>402,776</td>\n",
       "      <td>1995</td>\n",
       "      <td>Domestic</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>151,032</td>\n",
       "      <td>1995</td>\n",
       "      <td>International</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>557,234</td>\n",
       "      <td>1995</td>\n",
       "      <td>Total</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>436,647</td>\n",
       "      <td>1996</td>\n",
       "      <td>Domestic</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>156,796</td>\n",
       "      <td>1996</td>\n",
       "      <td>International</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>283,189</td>\n",
       "      <td>2018</td>\n",
       "      <td>International</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1,016,918</td>\n",
       "      <td>2018</td>\n",
       "      <td>Total</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>762,889</td>\n",
       "      <td>2019</td>\n",
       "      <td>Domestic</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>295,009</td>\n",
       "      <td>2019</td>\n",
       "      <td>International</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1,060,859</td>\n",
       "      <td>2019</td>\n",
       "      <td>Total</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>75 rows  3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         Revenue  Year       Category\n",
       "0       402,776   1995       Domestic\n",
       "0       151,032   1995  International\n",
       "0       557,234   1995          Total\n",
       "1       436,647   1996       Domestic\n",
       "1       156,796   1996  International\n",
       "..           ...   ...            ...\n",
       "23      283,189   2018  International\n",
       "23    1,016,918   2018          Total\n",
       "24      762,889   2019       Domestic\n",
       "24      295,009   2019  International\n",
       "24    1,060,859   2019          Total\n",
       "\n",
       "[75 rows x 3 columns]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_tr_area = pd.DataFrame(df_tr[['Total Revenue Passenger Miles','Year']])\n",
    "df_tr_area.columns = ['Revenue','Year']\n",
    "df_tr_area['Category'] = ['Total' for i in range(25)]\n",
    "\n",
    "df_tr_temp = pd.DataFrame(df_tr[['Total Domestic Revenue Passenger Miles','Year']])\n",
    "df_tr_temp.columns = ['Revenue','Year']\n",
    "df_tr_temp['Category'] = ['Domestic' for i in range(25)]\n",
    "df_tr_area = df_tr_area.append(df_tr_temp)\n",
    "\n",
    "df_tr_temp = pd.DataFrame(df_tr[['Total International Revenue Passenger Miles','Year']])\n",
    "df_tr_temp.columns = ['Revenue','Year']\n",
    "df_tr_temp['Category'] = ['International' for i in range(25)]\n",
    "df_tr_area = df_tr_area.append(df_tr_temp)\n",
    "\n",
    "df_tr_area.sort_values(by=[\"Year\",\"Category\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tr.to_csv('total_rev_data.csv')\n",
    "df_tr_area.to_csv('total_rev_data_area.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>1960</th>\n",
       "      <th>1965</th>\n",
       "      <th>1970</th>\n",
       "      <th>1975</th>\n",
       "      <th>1980</th>\n",
       "      <th>1985</th>\n",
       "      <th>1990</th>\n",
       "      <th>1991</th>\n",
       "      <th>1992</th>\n",
       "      <th>...</th>\n",
       "      <th>2009</th>\n",
       "      <th>2010</th>\n",
       "      <th>2011</th>\n",
       "      <th>2012</th>\n",
       "      <th>2013</th>\n",
       "      <th>2014</th>\n",
       "      <th>2015</th>\n",
       "      <th>2016</th>\n",
       "      <th>2017</th>\n",
       "      <th>2018</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Total fatalities</td>\n",
       "      <td>499</td>\n",
       "      <td>261</td>\n",
       "      <td>146</td>\n",
       "      <td>124</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>526.000000</td>\n",
       "      <td>39.000000</td>\n",
       "      <td>50.000000</td>\n",
       "      <td>33.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>52.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Total seriously injured persons</td>\n",
       "      <td>N</td>\n",
       "      <td>N</td>\n",
       "      <td>107</td>\n",
       "      <td>81</td>\n",
       "      <td>19.000000</td>\n",
       "      <td>30.000000</td>\n",
       "      <td>29.000000</td>\n",
       "      <td>26.000000</td>\n",
       "      <td>22.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>26.000000</td>\n",
       "      <td>17.000000</td>\n",
       "      <td>21.000000</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>14.000000</td>\n",
       "      <td>24.000000</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>19.000000</td>\n",
       "      <td>25.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Total accidents</td>\n",
       "      <td>90</td>\n",
       "      <td>83</td>\n",
       "      <td>55</td>\n",
       "      <td>37</td>\n",
       "      <td>19.000000</td>\n",
       "      <td>21.000000</td>\n",
       "      <td>24.000000</td>\n",
       "      <td>26.000000</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>30.000000</td>\n",
       "      <td>30.000000</td>\n",
       "      <td>33.000000</td>\n",
       "      <td>26.000000</td>\n",
       "      <td>23.000000</td>\n",
       "      <td>31.000000</td>\n",
       "      <td>29.000000</td>\n",
       "      <td>30.000000</td>\n",
       "      <td>32.000000</td>\n",
       "      <td>30.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Fatal accidents</td>\n",
       "      <td>17</td>\n",
       "      <td>9</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Aircraft-miles (millions)</td>\n",
       "      <td>1130</td>\n",
       "      <td>1536</td>\n",
       "      <td>2685</td>\n",
       "      <td>2478</td>\n",
       "      <td>2924.000000</td>\n",
       "      <td>3631.000000</td>\n",
       "      <td>4947.832000</td>\n",
       "      <td>4824.824000</td>\n",
       "      <td>5039.435000</td>\n",
       "      <td>...</td>\n",
       "      <td>7465.598000</td>\n",
       "      <td>7598.128000</td>\n",
       "      <td>7713.557000</td>\n",
       "      <td>7660.072000</td>\n",
       "      <td>7672.511158</td>\n",
       "      <td>7690.949524</td>\n",
       "      <td>7822.203105</td>\n",
       "      <td>8016.961206</td>\n",
       "      <td>8154.971756</td>\n",
       "      <td>8473.725686</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Rates per 100 million aircraft-miles</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Fatalities</td>\n",
       "      <td>44.1593</td>\n",
       "      <td>16.9922</td>\n",
       "      <td>5.43762</td>\n",
       "      <td>5.00404</td>\n",
       "      <td>0.034200</td>\n",
       "      <td>14.486367</td>\n",
       "      <td>0.788224</td>\n",
       "      <td>1.036307</td>\n",
       "      <td>0.654835</td>\n",
       "      <td>...</td>\n",
       "      <td>0.696528</td>\n",
       "      <td>0.026322</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.117302</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.011801</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Seriously injured persons</td>\n",
       "      <td>N</td>\n",
       "      <td>N</td>\n",
       "      <td>3.9851</td>\n",
       "      <td>3.26877</td>\n",
       "      <td>0.649795</td>\n",
       "      <td>0.826219</td>\n",
       "      <td>0.586115</td>\n",
       "      <td>0.538880</td>\n",
       "      <td>0.436557</td>\n",
       "      <td>...</td>\n",
       "      <td>0.348264</td>\n",
       "      <td>0.223739</td>\n",
       "      <td>0.272248</td>\n",
       "      <td>0.234985</td>\n",
       "      <td>0.117302</td>\n",
       "      <td>0.182032</td>\n",
       "      <td>0.306819</td>\n",
       "      <td>0.224524</td>\n",
       "      <td>0.232987</td>\n",
       "      <td>0.295030</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Total accidents</td>\n",
       "      <td>7.9646</td>\n",
       "      <td>5.40365</td>\n",
       "      <td>2.04842</td>\n",
       "      <td>1.49314</td>\n",
       "      <td>0.649795</td>\n",
       "      <td>0.578353</td>\n",
       "      <td>0.485061</td>\n",
       "      <td>0.538880</td>\n",
       "      <td>0.357183</td>\n",
       "      <td>...</td>\n",
       "      <td>0.401843</td>\n",
       "      <td>0.394834</td>\n",
       "      <td>0.427818</td>\n",
       "      <td>0.339422</td>\n",
       "      <td>0.299771</td>\n",
       "      <td>0.403071</td>\n",
       "      <td>0.370740</td>\n",
       "      <td>0.374207</td>\n",
       "      <td>0.392399</td>\n",
       "      <td>0.354036</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Total accidents, fatal</td>\n",
       "      <td>1.50442</td>\n",
       "      <td>0.585938</td>\n",
       "      <td>0.297952</td>\n",
       "      <td>0.121065</td>\n",
       "      <td>0.034200</td>\n",
       "      <td>0.192784</td>\n",
       "      <td>0.121265</td>\n",
       "      <td>0.082905</td>\n",
       "      <td>0.079381</td>\n",
       "      <td>...</td>\n",
       "      <td>0.026790</td>\n",
       "      <td>0.013161</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.026067</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.011801</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows  36 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                             Unnamed: 0     1960      1965      1970  \\\n",
       "0                      Total fatalities      499       261       146   \n",
       "1       Total seriously injured persons        N         N       107   \n",
       "2                       Total accidents       90        83        55   \n",
       "3                       Fatal accidents       17         9         8   \n",
       "4             Aircraft-miles (millions)     1130      1536      2685   \n",
       "5  Rates per 100 million aircraft-miles      NaN       NaN       NaN   \n",
       "6                            Fatalities  44.1593   16.9922   5.43762   \n",
       "7             Seriously injured persons        N         N    3.9851   \n",
       "8                       Total accidents   7.9646   5.40365   2.04842   \n",
       "9                Total accidents, fatal  1.50442  0.585938  0.297952   \n",
       "\n",
       "       1975         1980         1985         1990         1991         1992  \\\n",
       "0       124     1.000000   526.000000    39.000000    50.000000    33.000000   \n",
       "1        81    19.000000    30.000000    29.000000    26.000000    22.000000   \n",
       "2        37    19.000000    21.000000    24.000000    26.000000    18.000000   \n",
       "3         3     1.000000     7.000000     6.000000     4.000000     4.000000   \n",
       "4      2478  2924.000000  3631.000000  4947.832000  4824.824000  5039.435000   \n",
       "5       NaN          NaN          NaN          NaN          NaN          NaN   \n",
       "6   5.00404     0.034200    14.486367     0.788224     1.036307     0.654835   \n",
       "7   3.26877     0.649795     0.826219     0.586115     0.538880     0.436557   \n",
       "8   1.49314     0.649795     0.578353     0.485061     0.538880     0.357183   \n",
       "9  0.121065     0.034200     0.192784     0.121265     0.082905     0.079381   \n",
       "\n",
       "   ...         2009         2010         2011         2012         2013  \\\n",
       "0  ...    52.000000     2.000000     0.000000     0.000000     9.000000   \n",
       "1  ...    26.000000    17.000000    21.000000    18.000000     9.000000   \n",
       "2  ...    30.000000    30.000000    33.000000    26.000000    23.000000   \n",
       "3  ...     2.000000     1.000000     0.000000     0.000000     2.000000   \n",
       "4  ...  7465.598000  7598.128000  7713.557000  7660.072000  7672.511158   \n",
       "5  ...          NaN          NaN          NaN          NaN          NaN   \n",
       "6  ...     0.696528     0.026322     0.000000     0.000000     0.117302   \n",
       "7  ...     0.348264     0.223739     0.272248     0.234985     0.117302   \n",
       "8  ...     0.401843     0.394834     0.427818     0.339422     0.299771   \n",
       "9  ...     0.026790     0.013161     0.000000     0.000000     0.026067   \n",
       "\n",
       "          2014         2015         2016         2017         2018  \n",
       "0     0.000000     0.000000     0.000000     0.000000     1.000000  \n",
       "1    14.000000    24.000000    18.000000    19.000000    25.000000  \n",
       "2    31.000000    29.000000    30.000000    32.000000    30.000000  \n",
       "3     0.000000     0.000000     0.000000     0.000000     1.000000  \n",
       "4  7690.949524  7822.203105  8016.961206  8154.971756  8473.725686  \n",
       "5          NaN          NaN          NaN          NaN          NaN  \n",
       "6     0.000000     0.000000     0.000000     0.000000     0.011801  \n",
       "7     0.182032     0.306819     0.224524     0.232987     0.295030  \n",
       "8     0.403071     0.370740     0.374207     0.392399     0.354036  \n",
       "9     0.000000     0.000000     0.000000     0.000000     0.011801  \n",
       "\n",
       "[10 rows x 36 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "us_url = \"https://www.bts.gov/sites/bts.dot.gov/files/table_02_09_121819.xlsx\"\n",
    "us_df = pd.read_excel(us_url, skiprows=1)\n",
    "us_df.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "us_years = us_df.columns.tolist()[1:]\n",
    "us_acc_rate = us_df.iloc[8].tolist()[1:]\n",
    "us_fatal_rate = us_df.iloc[9].tolist()[1:]\n",
    "us_miles_flown = us_df.iloc[4].tolist()[1:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Years</th>\n",
       "      <th>Accident_Rate</th>\n",
       "      <th>Fatality_Rate</th>\n",
       "      <th>Miles_Flown</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1960</td>\n",
       "      <td>7.964602</td>\n",
       "      <td>1.504425</td>\n",
       "      <td>1.130000e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1965</td>\n",
       "      <td>5.403646</td>\n",
       "      <td>0.585938</td>\n",
       "      <td>1.536000e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1970</td>\n",
       "      <td>2.048417</td>\n",
       "      <td>0.297952</td>\n",
       "      <td>2.685000e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1975</td>\n",
       "      <td>1.493140</td>\n",
       "      <td>0.121065</td>\n",
       "      <td>2.478000e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1980</td>\n",
       "      <td>0.649795</td>\n",
       "      <td>0.034200</td>\n",
       "      <td>2.924000e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1985</td>\n",
       "      <td>0.578353</td>\n",
       "      <td>0.192784</td>\n",
       "      <td>3.631000e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1990</td>\n",
       "      <td>0.485061</td>\n",
       "      <td>0.121265</td>\n",
       "      <td>4.947832e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1991</td>\n",
       "      <td>0.538880</td>\n",
       "      <td>0.082905</td>\n",
       "      <td>4.824824e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1992</td>\n",
       "      <td>0.357183</td>\n",
       "      <td>0.079381</td>\n",
       "      <td>5.039435e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1993</td>\n",
       "      <td>0.438140</td>\n",
       "      <td>0.019050</td>\n",
       "      <td>5.249469e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1994</td>\n",
       "      <td>0.419852</td>\n",
       "      <td>0.073018</td>\n",
       "      <td>5.478118e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>1995</td>\n",
       "      <td>0.636710</td>\n",
       "      <td>0.053059</td>\n",
       "      <td>5.654069e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1996</td>\n",
       "      <td>0.629990</td>\n",
       "      <td>0.085134</td>\n",
       "      <td>5.873108e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>1997</td>\n",
       "      <td>0.731710</td>\n",
       "      <td>0.059731</td>\n",
       "      <td>6.696638e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>1998</td>\n",
       "      <td>0.742220</td>\n",
       "      <td>0.014844</td>\n",
       "      <td>6.736543e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>1999</td>\n",
       "      <td>0.718177</td>\n",
       "      <td>0.028164</td>\n",
       "      <td>7.101314e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2000</td>\n",
       "      <td>0.744282</td>\n",
       "      <td>0.039872</td>\n",
       "      <td>7.524027e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2001</td>\n",
       "      <td>0.630639</td>\n",
       "      <td>0.082257</td>\n",
       "      <td>7.294191e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2002</td>\n",
       "      <td>0.570038</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>7.192501e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>2003</td>\n",
       "      <td>0.741719</td>\n",
       "      <td>0.027471</td>\n",
       "      <td>7.280383e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2004</td>\n",
       "      <td>0.378303</td>\n",
       "      <td>0.025220</td>\n",
       "      <td>7.930159e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>2005</td>\n",
       "      <td>0.489857</td>\n",
       "      <td>0.036739</td>\n",
       "      <td>8.165643e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2006</td>\n",
       "      <td>0.405437</td>\n",
       "      <td>0.024572</td>\n",
       "      <td>8.139357e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>2007</td>\n",
       "      <td>0.336704</td>\n",
       "      <td>0.012025</td>\n",
       "      <td>8.315905e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>2008</td>\n",
       "      <td>0.334643</td>\n",
       "      <td>0.024788</td>\n",
       "      <td>8.068288e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>2009</td>\n",
       "      <td>0.401843</td>\n",
       "      <td>0.026790</td>\n",
       "      <td>7.465598e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>2010</td>\n",
       "      <td>0.394834</td>\n",
       "      <td>0.013161</td>\n",
       "      <td>7.598128e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>2011</td>\n",
       "      <td>0.427818</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>7.713557e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>2012</td>\n",
       "      <td>0.339422</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>7.660072e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>2013</td>\n",
       "      <td>0.299771</td>\n",
       "      <td>0.026067</td>\n",
       "      <td>7.672511e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>2014</td>\n",
       "      <td>0.403071</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>7.690950e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>2015</td>\n",
       "      <td>0.370740</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>7.822203e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>2016</td>\n",
       "      <td>0.374207</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>8.016961e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>2017</td>\n",
       "      <td>0.392399</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>8.154972e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>2018</td>\n",
       "      <td>0.354036</td>\n",
       "      <td>0.011801</td>\n",
       "      <td>8.473726e+09</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Years  Accident_Rate  Fatality_Rate   Miles_Flown\n",
       "0    1960       7.964602       1.504425  1.130000e+09\n",
       "1    1965       5.403646       0.585938  1.536000e+09\n",
       "2    1970       2.048417       0.297952  2.685000e+09\n",
       "3    1975       1.493140       0.121065  2.478000e+09\n",
       "4    1980       0.649795       0.034200  2.924000e+09\n",
       "5    1985       0.578353       0.192784  3.631000e+09\n",
       "6    1990       0.485061       0.121265  4.947832e+09\n",
       "7    1991       0.538880       0.082905  4.824824e+09\n",
       "8    1992       0.357183       0.079381  5.039435e+09\n",
       "9    1993       0.438140       0.019050  5.249469e+09\n",
       "10   1994       0.419852       0.073018  5.478118e+09\n",
       "11   1995       0.636710       0.053059  5.654069e+09\n",
       "12   1996       0.629990       0.085134  5.873108e+09\n",
       "13   1997       0.731710       0.059731  6.696638e+09\n",
       "14   1998       0.742220       0.014844  6.736543e+09\n",
       "15   1999       0.718177       0.028164  7.101314e+09\n",
       "16   2000       0.744282       0.039872  7.524027e+09\n",
       "17   2001       0.630639       0.082257  7.294191e+09\n",
       "18   2002       0.570038       0.000000  7.192501e+09\n",
       "19   2003       0.741719       0.027471  7.280383e+09\n",
       "20   2004       0.378303       0.025220  7.930159e+09\n",
       "21   2005       0.489857       0.036739  8.165643e+09\n",
       "22   2006       0.405437       0.024572  8.139357e+09\n",
       "23   2007       0.336704       0.012025  8.315905e+09\n",
       "24   2008       0.334643       0.024788  8.068288e+09\n",
       "25   2009       0.401843       0.026790  7.465598e+09\n",
       "26   2010       0.394834       0.013161  7.598128e+09\n",
       "27   2011       0.427818       0.000000  7.713557e+09\n",
       "28   2012       0.339422       0.000000  7.660072e+09\n",
       "29   2013       0.299771       0.026067  7.672511e+09\n",
       "30   2014       0.403071       0.000000  7.690950e+09\n",
       "31   2015       0.370740       0.000000  7.822203e+09\n",
       "32   2016       0.374207       0.000000  8.016961e+09\n",
       "33   2017       0.392399       0.000000  8.154972e+09\n",
       "34   2018       0.354036       0.011801  8.473726e+09"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "us_data = pd.DataFrame(us_df.columns.tolist()[1:], columns = [\"Years\"])\n",
    "us_data['Accident_Rate'] = us_acc_rate\n",
    "us_data['Fatality_Rate'] = us_fatal_rate\n",
    "us_data['Miles_Flown'] = us_miles_flown\n",
    "us_data['Miles_Flown'] = us_data['Miles_Flown']*1000000\n",
    "us_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "us_data.to_csv('us_accident_data.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "flights_url = 'https://www.bts.dot.gov/annual-passengers-all-us-scheduled-airline-flights-domestic-international-and-foreign-airline'\n",
    "\n",
    "flights_html_content = requests.get(flights_url).text\n",
    "\n",
    "soup_flights = BeautifulSoup(flights_html_content, \"lxml\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Year</th>\n",
       "      <th>Total</th>\n",
       "      <th>Domestic</th>\n",
       "      <th>International</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2003</td>\n",
       "      <td>700.9</td>\n",
       "      <td>583.3</td>\n",
       "      <td>117.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2004</td>\n",
       "      <td>763.7</td>\n",
       "      <td>629.8</td>\n",
       "      <td>133.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2005</td>\n",
       "      <td>800.8</td>\n",
       "      <td>657.3</td>\n",
       "      <td>143.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2006</td>\n",
       "      <td>808.1</td>\n",
       "      <td>658.4</td>\n",
       "      <td>149.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2007</td>\n",
       "      <td>835.5</td>\n",
       "      <td>679.2</td>\n",
       "      <td>156.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2008</td>\n",
       "      <td>809.8</td>\n",
       "      <td>651.7</td>\n",
       "      <td>158.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2009</td>\n",
       "      <td>767.8</td>\n",
       "      <td>618.1</td>\n",
       "      <td>149.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2010</td>\n",
       "      <td>787.5</td>\n",
       "      <td>629.5</td>\n",
       "      <td>157.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2011</td>\n",
       "      <td>802.1</td>\n",
       "      <td>638.2</td>\n",
       "      <td>163.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2012</td>\n",
       "      <td>813.1</td>\n",
       "      <td>642.3</td>\n",
       "      <td>170.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2013</td>\n",
       "      <td>825.3</td>\n",
       "      <td>645.7</td>\n",
       "      <td>179.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>2014</td>\n",
       "      <td>851.8</td>\n",
       "      <td>662.8</td>\n",
       "      <td>189.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>2015</td>\n",
       "      <td>896.6</td>\n",
       "      <td>696.0</td>\n",
       "      <td>200.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2016</td>\n",
       "      <td>932.0</td>\n",
       "      <td>720.0</td>\n",
       "      <td>212.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2017</td>\n",
       "      <td>965.4</td>\n",
       "      <td>741.7</td>\n",
       "      <td>223.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2018</td>\n",
       "      <td>1,011.5</td>\n",
       "      <td>777.9</td>\n",
       "      <td>233.6</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Year    Total Domestic International\n",
       "0   2003    700.9    583.3         117.6\n",
       "1   2004    763.7    629.8         133.9\n",
       "2   2005    800.8    657.3         143.6\n",
       "3   2006    808.1    658.4         149.7\n",
       "4   2007    835.5    679.2         156.3\n",
       "5   2008    809.8    651.7         158.1\n",
       "6   2009    767.8    618.1         149.7\n",
       "7   2010    787.5    629.5         157.9\n",
       "8   2011    802.1    638.2         163.9\n",
       "9   2012    813.1    642.3         170.8\n",
       "10  2013    825.3    645.7         179.6\n",
       "11  2014    851.8    662.8         189.0\n",
       "12  2015    896.6    696.0         200.6\n",
       "13  2016    932.0    720.0         212.0\n",
       "14  2017    965.4    741.7         223.7\n",
       "15  2018  1,011.5    777.9         233.6"
      ]
     },
     "execution_count": 112,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flights_table = soup_flights.find_all(\"table\")[0]\n",
    "flight_results = pd.DataFrame()\n",
    "rows = flights_table.find_all('tr')\n",
    "for row in rows:\n",
    "    data = row.find_all('td')\n",
    "    row_data = [ x.text for x in data ]\n",
    "    temp_df = pd.DataFrame([row_data])\n",
    "\n",
    "    flight_df = flight_results.append(temp_df)\n",
    "\n",
    "flight_results = flight_results.dropna(how='all').reset_index(drop = True)\n",
    "flight_results.columns = ['Year', 'Total', 'Domestic', 'International']\n",
    "flight_results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "metadata": {},
   "outputs": [],
   "source": [
    "flight_results.to_csv('flight_totals.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
